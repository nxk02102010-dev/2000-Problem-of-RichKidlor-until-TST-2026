Cho mảng A n số nguyên. Cho q truy vấn có 2 dạng:
1 l r x : Tăng đoạn l -> r lên x đơn vị
2 l r : Tổng đoạn l -> r.


#include <bits/stdc++.h>
using namespace std;
//Coder:RichKidlor in 10IT CTL_DL
//Contest : Codeforces,Vnoi,Clueoj,TLOI
#define FOR(i,a,b) for(int i = (a);i < (b);i++)
#define REP(i,a,b) for(int i = (a);i <= (b);i++)
#define REPD(i,a,b) for(int i = (a); i >= (b);i--)
#define FORD(i,a,b) for(int i = (a);i > (b);i--)
#define F first
#define S second
#define pb push_back
#define BIT(mask,i) (mask) & (1 << (i))
#define CHECK(mask,i) (((mask) >> (i)) & 1)
#define all(x) (x).begin(), (x).end()
#define sz(x) (int)(x).size()
#define pii pair<int,int>
#define pil pair<int,ll>
#define pll pair<ll,ll>
#define allr(x) (x).rbegin(),(x).rend()
#define pli pair<ll,int>
#define nocout cout << "NO" << '\n'
#define yescout cout << "YES" << '\n'
#define INF (ll) 1e18
#define iINF 1e9
#define i128 __int128_t
#define minusone cout << -1 << '\n'
#define ar array
#define EP emplace_back
#define I ios::sync_with_stdio(0);
#define LOVE cin.tie(0);
#define GB cout.tie(0);
//#include<ext/pb_ds/assoc_container.hpp>
//using namespace __gnu_pbds;
//template<class T> using ordered_set = tree<T,null_type,less<T>,rb_tree_tag,tree_order_statistics_node_update>;
#define STR(x) #x
#define FileName(x) STR(x)
//#define File chondua
#pragma GCC optimize("Ofast,unroll-loops")
#pragma GCC target("avx2")
#define int long long
//#define ll __int128
#define ll long long
template<class X,class Y>bool maximize (X &x,const Y &y){if(x < y){x = y;return 1;}return 0;}
template<class X,class Y> bool minimize (X &x,const Y &y){if(x > y){x = y;return 1;}return 0;}
namespace Love{
const int MAX = 100100;
int n,bitAdd[MAX],prefix[MAX],bitMul[MAX],a[MAX];
void up(int bit[],int p,int v){
    while(p <= n){
        bit[p] += v;
        p += p & -p;
    }
}
int get(int bit[],int p){
    int res = 0;
    while(p){
        res += bit[p];
        p -= p &-p;
    }
    return res;
}
void upR(int l,int r,int v){
    up(bitMul,l,v);
    up(bitMul,r + 1,-v);
    up(bitAdd,l,-v * (l - 1));
    up(bitAdd,r + 1,v * r);
}
int getP(int p){
    return get(bitMul,p) * p + get(bitAdd,p);
}
int getS(int l,int r){
    return getP(r) - getP(l - 1);
}
void solve(void){
    cin >> n;
    int q;cin >> q;
    REP(i,1,n) cin >> a[i],prefix[i] = prefix[i - 1] + a[i];
    while(q--){
        int type;cin >> type;
        int a,b,c;
        if(type == 1){
            cin >> a >> b >> c;
            upR(a,b,c);
        }
        else{
            cin >> a >> b;
            cout << prefix[b] - prefix[a - 1] + getS(a,b) << '\n';
        }
    }
}
}
signed main(){
    //freopen("DoiCuuTroIT.Inp","r",stdin);
    //freopen("DoiCuuTroIT.Out","w",stdout);
#ifdef File
    freopen(FileName(File)".inp","r",stdin);
    freopen(FileName(File)".out","w",stdout);
#endif
    I LOVE GB;
    ll t = 1;//cin >> t;
    while(t--)
    Love :: solve();
    return 0;
}
