https://oj.clue.edu.vn/problem/hn_hsg9_26_e


#include<bits/stdc++.h>
using namespace std;
#define int long long
const int MAX = 200100;
int n,a[MAX],k;
void PREPARE(){
    cin >> n >> k;
    for(int i = 1;i <= n;i++ )cin >> a[i];
}
int P(int a,int b){
    int r = 1;
    for(;b;a = a * a,b >>= 1) if(b & 1) r = r * a;
    return r;
}
namespace sub2{
    bool check(){
        return k == 1;
    }
    void solve(){
        int i = 1;
        while(a[i] == 0) i++;
        int f = i;
        int s = 0;
        for(;i <= n;i++){
            s = max(s,a[i] + P(i - f,2));
        }
        cout << s << '\n';
    }
}
namespace sub3{
    bool check(){
        return n <= 1000;
    }
    bool check(int m){
        vector<int> v;
        for(int i = 1;i <= n;i++) v.push_back(a[i]);
        int s = 0;
        for(int i = 0;i < n;i++){
            if(v[i] <= 0) continue;
            if(v[i] / m + (v[i] % m > 0 ? 1 : 0) + s > k) return 0;
            for(int j = i + 1;j < n && m - P(j - i,2) > 0;j++){
                v[j] -= (v[i] / m + (v[i] % m > 0 ? 1 : 0)) * (m - P(j - i,2));
            }
            s += v[i] / m + (v[i] % m > 0 ? 1 : 0);
            v[i] -= (v[i] / m + (v[i] % m > 0 ? 1 : 0)) * (m);
            if(s > k) return 0;
        }
        return 1;
    }
    void solve(){
        int l = 0,r = 1e12;
        int ans = -1;
        while(l <= r){
            int m =(l + r) >> 1;
            if(check(m)){
                ans = m;
                r= m - 1;
            }
            else l = m + 1;
        }
        cout << ans << '\n';
    }
}
namespace sub4{
    bool check(){
        return true;
    }
    bool check(long long m){
        vector<long long> v(a + 1, a + n + 1);
        deque<pair<int,long long>> shots;
        long long used = 0;
        for(int i = 0; i < n; i++){
            while(!shots.empty()){
                int pos = shots.front().first;
                if(m - 1LL * (i - pos) * (i - pos) <= 0)
                    shots.pop_front();
                else
                    break;
            }
            for(auto &sh : shots){
                int pos = sh.first;
                long long cnt = sh.second;
                long long dmg = m - 1LL * (i - pos) * (i - pos);
                v[i] -= dmg * cnt;
            }
            if(v[i] > 0){
                long long need = (v[i] + m - 1) / m;
                used += need;
                if(used > k) return false;

                shots.emplace_back(i, need);
            }
        }
        return true;
    }

    void solve(){
        long long l = 0, r = 1e12, ans = -1;
        while(l <= r){
            long long m = (l + r) >> 1;
            if(check(m)){
                ans = m;
                r = m - 1;
            } else {
                l = m + 1;
            }
        }
        cout << ans << '\n';
    }
}
signed main(){
    ios::sync_with_stdio(0);cin.tie(0);cout.tie(0);
    PREPARE();
    if(sub2::check()) sub2::solve();
    else if(sub3::check()) sub3::solve();
    else sub4::solve();
}
