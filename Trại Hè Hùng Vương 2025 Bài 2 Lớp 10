https://oj.clue.edu.vn/problem/thhv25_road


#include<bits/stdc++.h>
using namespace std;
#define int long long
#define F first
#define S second
const int MAX = 100100,INF = (int)1e18;
struct E{
    int v,w,b;
};
vector<E> g[MAX],gr[MAX];
int n,m,X,k;
void buildGraph(){
    cin >> n >> m >> k >> X;
    for(int i = 0;i < m;i++){
        int a,b,c,d;cin >> a >> b >> c >> d;
        g[a].push_back({b,c,d});
        gr[b].push_back({a,c,d});
    }
}
vector<int> dijsktra(int S,bool bike,bool rev){
    vector<int> dist(n + 1,INF);
    priority_queue<pair<int,int>,vector<pair<int,int>>,greater<pair<int,int>>> q;
    q.push({0,S});
    dist[S] = 0;
    while(q.size()){
        auto top = q.top();q.pop();
        int u = top.S;
        int w1 = top.F;
        if(!rev)
            for(auto to : g[u]) {
                int v = to.v;
                int w2;
                if(bike){
                    w2 = to.b;
                }
                else{
                    w2 = to.w;
                }
                if(dist[v] > w1 + w2){
                    dist[v] = w1 + w2;
                    q.push({dist[v],v});
                }
            }
        else{
             for(auto to : gr[u]) {
                int v = to.v;
                int w2;
                if(bike){
                    w2 = to.b;
                }
                else{
                    w2 = to.w;
                }
                if(dist[v] > w1 + w2){
                    dist[v] = w1 + w2;
                    q.push({dist[v],v});
                }
            }
        }
    }
    return dist;
}
void solve(void){
    vector<int> W2 = dijsktra(1,1,0);
    vector<int> W3 = dijsktra(n,1,1);
    vector<int> W4 = dijsktra(k,0,1);
    int ans = INF;
    for(int u = 1;u <= n;u++){
        if(W2[u] == INF || W3[u] == INF || W4[u] == INF) continue;
        if(W2[u] + W4[u] <= X) ans = min(ans,W2[u] + W3[u]);
    }
    cout << (ans == INF ? -1 : ans) << '\n';
}
signed main(){
    ios::sync_with_stdio(0);cin.tie(0);cout.tie(0);
    buildGraph();
    solve();
}
